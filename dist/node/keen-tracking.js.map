{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/keen-core/lib/utils/each.js","webpack:///./node_modules/promise-polyfill/src/finally.js","webpack:///./node_modules/promise-polyfill/src/index.js","webpack:///./node_modules/promise-polyfill/src/polyfill.js","webpack:///./lib/config-default.js","webpack:///./node_modules/keen-core/lib/utils/extend.js","webpack:///./lib/index.js","webpack:///./lib/utils/deepExtend.js","webpack:///./lib/extend-events.js","webpack:///./lib/utils/queue.js","webpack:///./lib/utils/timer.js","webpack:///./lib/helpers/getUniqueId.js","webpack:///./lib/helpers/getDatetimeIndex.js","webpack:///./lib/defer-events.js","webpack:///./lib/utils/cache-node.js","webpack:///./lib/utils/md5.js","webpack:///./lib/utils/unique.js","webpack:///external \"https\"","webpack:///external \"http\"","webpack:///./lib/utils/nodeRequestRetry.js","webpack:///./lib/record-events-server.js","webpack:///./lib/utils/localStorage.js","webpack:///./lib/utils/optOut.js","webpack:///external \"component-emitter\"","webpack:///external \"keen-core\"","webpack:///./lib/server.js"],"names":["configDefault","queue","capacity","interval","retry","limit","initialDelay","retryOnResponseStatuses","unique","cache","dbName","dbCollectionName","dbCollectionKey","maxAge","KeenCore","helpers","prototype","observers","on","client","extensions","events","collections","config","respectDoNotTrack","doNotTrack","optOut","optedOut","recordDeferredEvents","writeKey","str","arguments","length","String","referrerPolicy","setGlobalProperties","props","log","version","pkg","deepExtend","target","i","Array","j","indexOf","push","prop","clone","undefined","input","JSON","parse","stringify","extendEvent","extendEvents","getExtendedEventBody","eventCollection","eventModifier","handleValidationError","call","emit","eventsModifier","message","result","modifierResult","configQueue","timer","check","shouldFlushQueue","flush","pause","clearInterval","start","self","setInterval","num","count","value","clear","getUniqueId","crypto","getRandomValues","replace","c","Uint8Array","toString","r","Math","random","v","getDatetimeIndex","date","Date","getHours","parseInt","getDay","getDate","getMonth","getFullYear","deferEvent","deferEvents","queueCapacity","queueInterval","eventBody","eventsHash","eventList","concat","Number","clonedQueueConfig","clonedQueueEvents","recordEvents","err","res","module","exports","getFromCache","saveToCache","MD5","d","M","V","Y","X","toLowerCase","_","m","f","charCodeAt","charAt","fromCharCode","n","h","t","g","e","md5_ii","md5_hh","md5_gg","md5_ff","safe_add","md5_cmn","bit_rol","uniqueIds","isUnique","customCacheConfig","extendedEventBody","configCache","stringifiedEvent","hashingMethod","hash","expiryTime","now","item","filter","alreadySentEvent","find","Promise","resolve","storage","then","options","configRetry","retriesLimit","retryInitialDelay","retryOn","callback","retriesCount","name","protocol","http","https","parseBody","responseBody","reject","response","error","error_code","Error","code","wrappedRequest","req","request","body","statusCode","parsedBody","catch","write","data","end","setTimeout","recordEvent","eventCollectionOrConfigObject","configObject","clientConfig","collection","event_collection","event","checkValidation","isUniqueResult","created","Keen","enabled","sendEventData","encodeURIComponent","extendedEventsHash","index","projectId","cb","path","eventData","urlPath","url","host","method","headers","Buffer","byteLength","nodeRequestConfig","lsTest","test","localStorage","setItem","removeItem","isLocalStorageAvailable","setOptOut","utils","KeenTracking"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;ACnEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;;ACdA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEA;;;ACnOA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;;;;ACvBO,IAAMA,wCAAgB;;AAE3B;AACA;AACAC,SAAO;AACLC,cAAU,IADL;AAELC,cAAU;AAFL,GAJoB;;AAS3B;AACAC,SAAO;AACLC,WAAO,EADF;AAELC,kBAAc,GAFT;AAGLC,6BAAyB,CACvB,GADuB,EAEvB,GAFuB,EAGvB,GAHuB,EAIvB,GAJuB,EAKvB,GALuB;AAHpB,GAVoB;;AAsB3BC,UAAQ,KAtBmB,EAsBZ;AACf;AACAC,SAAO;AACL;;;AAGAC,YAAQ,cAJH,EAImB;AACxBC,sBAAkB,QALb;AAMLC,qBAAiB,MANZ;;AAQL;;;AAGAC,YAAQ,KAAK,IAXR,CAWc;AAXd;AAxBoB,CAAtB;;kBAuCQb,a;;;;;;ACvCf;;AAEA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AAC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","file":"node/keen-tracking.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"component-emitter\"), require(\"keen-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"component-emitter\", \"keen-core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"component-emitter\"), require(\"keen-core\")) : factory(root[\"component-emitter\"], root[\"keen-core\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function(__WEBPACK_EXTERNAL_MODULE__22__, __WEBPACK_EXTERNAL_MODULE__23__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","module.exports = each;\n\nfunction each(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","export default function(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  this._state = 0;\n  this._handled = false;\n  this._value = undefined;\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import Promise from './index';\nimport promiseFinally from './finally';\n\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\nif (!globalNS.Promise) {\n  globalNS.Promise = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n}\n","export const configDefault = {\n\n  // defer events - queue\n  // https://github.com/keen/keen-tracking.js/blob/master/docs/defer-events.md\n  queue: {\n    capacity: 5000,\n    interval: 15,\n  },\n\n  // connection problems - retry request\n  retry: {\n    limit: 10,\n    initialDelay: 200,\n    retryOnResponseStatuses: [\n      408,\n      500,\n      502,\n      503,\n      504\n    ]\n  },\n\n  unique: false, // record only unique events?\n  // if so - store unique events hashes to compare\n  cache: {\n    /*\n      storage: 'indexeddb', // uncomment for persistence\n    */\n    dbName: 'keenTracking', // indexedDB name\n    dbCollectionName: 'events',\n    dbCollectionKey: 'hash',\n\n    /*\n      hashingMethod: 'md5', // if undefined - store as stringified JSON\n    */\n    maxAge: 60 * 1000, // store for 1 minute\n  }\n}\n\nexport default configDefault;\n","module.exports = extend;\n\nfunction extend(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n","import KeenCore from 'keen-core';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { queue } from './utils/queue';\nimport { setOptOut } from './utils/optOut';\nimport pkg from '../package.json';\n\nKeenCore.helpers = KeenCore.helpers || {};\nKeenCore.prototype.observers = KeenCore.observers || {};\n\n// Install internal queue\nKeenCore.on('client', function(client){\n  client.extensions = {\n    events: [],\n    collections: {}\n  };\n  \n  if (!client.config.respectDoNotTrack) {\n    this.doNotTrack = false;\n  }\n\n  if (typeof client.config.optOut !== 'undefined') {\n    setOptOut(client.config.optOut);\n    this.optedOut = client.config.optOut;\n  }\n  \n  client.queue = queue(client.config.queue);\n  client.queue.on('flush', function(){\n    client.recordDeferredEvents();\n  });\n});\n\n// Accessors\nKeenCore.prototype.writeKey = function(str){\n  if (!arguments.length) return this.config.writeKey;\n  this.config.writeKey = (str ? String(str) : null);\n  return this;\n};\n\nKeenCore.prototype.referrerPolicy = function(str){\n  if (!arguments.length) return this.config.referrerPolicy;\n  this.config.referrerPolicy = (str ? String(str) : null);\n  return this;\n};\n\n// DEPRECATED\nKeenCore.prototype.setGlobalProperties = function(props){\n  KeenCore.log('This method has been removed. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events');\n  return this;\n};\n\nKeenCore.version = pkg.version;\n\nexport default KeenCore;\n","export const deepExtend = function(target){\n  for (var i = 1; i < arguments.length; i++) {\n    // Copy unique items from incoming array\n    if (target instanceof Array && arguments[i] instanceof Array) {\n      for (var j = 0; j < arguments[i].length; j++) {\n        if (target.indexOf(arguments[i][j]) < 0) {\n          target.push(arguments[i][j]);\n        }\n      }\n    }\n    // Blend objects\n    else {\n      for (var prop in arguments[i]){\n        // Recurse when both contain objects of same name\n        // and incoming is not a null object\n        if (typeof target[prop] !== 'undefined'\n          && typeof target[prop] === 'object'\n          && typeof arguments[i][prop] === 'object'\n          && arguments[i][prop] !== null) {\n            deepExtend(target[prop], clone(arguments[i][prop]));\n        }\n        // Otherwise just copy it over...\n        else if (\n          arguments[i][prop] !== undefined &&\n          typeof arguments[i][prop] !== 'function') {\n            target[prop] = clone(arguments[i][prop]);\n        }\n      }\n    }\n  }\n  return target;\n}\n\nfunction clone(input){\n  return JSON.parse( JSON.stringify(input) );\n}\n","import { deepExtend } from './utils/deepExtend';\nimport each from 'keen-core/lib/utils/each';\n\nexport function extendEvent(eventCollection, eventModifier){\n  if (arguments.length !== 2 || typeof eventCollection !== 'string'\n    || ('object' !== typeof eventModifier && 'function' !== typeof eventModifier)) {\n      handleValidationError.call(this, 'Incorrect arguments provided to #extendEvent method');\n      return;\n  }\n  this.extensions.collections[eventCollection] = this.extensions.collections[eventCollection] || [];\n  this.extensions.collections[eventCollection].push(eventModifier);\n  this.emit('extendEvent', eventCollection, eventModifier);\n  return this;\n}\n\nexport function extendEvents(eventsModifier){\n  if (arguments.length !== 1 || ('object' !== typeof eventsModifier && 'function' !== typeof eventsModifier)) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #extendEvents method');\n    return;\n  }\n  this.extensions.events.push(eventsModifier);\n  this.emit('extendEvents', eventsModifier);\n  return this;\n}\n\nfunction handleValidationError(message){\n  this.emit('error', `Event(s) not extended: ${message}`);\n}\n\nexport function getExtendedEventBody(result, queue){\n  if (queue && queue.length > 0) {\n    each(queue, function(eventModifier, i){\n      let modifierResult = (typeof eventModifier === 'function') ? eventModifier() : eventModifier;\n      deepExtend(result, modifierResult);\n    });\n  }\n  return result;\n}\n","import Emitter from 'component-emitter';\n\nimport configDefault from '../config-default.js';\n\nexport function queue(configQueue = {}) {\n  if (this instanceof queue === false) {\n    return new queue(configQueue);\n  }\n  this.capacity = 0;\n  this.config = {\n    ...configDefault.queue,\n    ...configQueue\n  };\n  this.events = {\n    // \"collection-1\": [],\n    // \"collection-2\": []\n  };\n  this.interval = 0;\n  this.timer = null;\n  return this;\n}\n\nEmitter(queue.prototype);\n\nqueue.prototype.check = function() {\n  if (shouldFlushQueue(this)) {\n    this.flush();\n  }\n  if (this.config.interval === 0 || this.capacity === 0) {\n    this.pause();\n  }\n  return this;\n};\n\nqueue.prototype.flush = function() {\n  this.emit('flush');\n  this.interval = 0;\n  return this;\n};\n\nqueue.prototype.pause = function() {\n  if (this.timer) {\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n  return this;\n};\n\nqueue.prototype.start = function() {\n  var self = this;\n  self.pause();\n  self.timer = setInterval(function() {\n    self.interval++;\n    self.check();\n  }, 1000);\n  return self;\n};\n\nfunction shouldFlushQueue(props) {\n  if (props.capacity > 0 && props.interval >= props.config.interval) {\n    return true;\n  }\n  else if (props.capacity >= props.config.capacity) {\n    return true;\n  }\n  return false;\n}\n","export function timer(num){\n  if (this instanceof timer === false) {\n    return new timer(num);\n  }\n  this.count = num || 0;\n  return this;\n}\n\ntimer.prototype.start = function(){\n  var self = this;\n  this.pause();\n  this.interval = setInterval(function(){\n    self.count++;\n  }, 1000);\n  return this;\n};\n\ntimer.prototype.pause = function(){\n  clearInterval(this.interval);\n  return this;\n};\n\ntimer.prototype.value = function(){\n  return this.count;\n};\n\ntimer.prototype.clear = function(){\n  this.count = 0;\n  return this;\n};\n","export function getUniqueId() {\n  // uuidv4\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    // browser\n    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n      (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n    )\n  } else {\n    // node & older browsers\n    let str = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n    return str.replace(/[xy]/g, function(c) {\n      let r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n      return v.toString(16);\n    });\n  }\n}\n","export function getDatetimeIndex(input){\n  var date = input || new Date();\n  return {\n    'hour_of_day'  : date.getHours(),\n    'day_of_week'  : parseInt( 1 + date.getDay() ),\n    'day_of_month' : date.getDate(),\n    'month'        : parseInt( 1 + date.getMonth() ),\n    'year'         : date.getFullYear()\n  };\n}\n","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport { queue } from './utils/queue';\n\nexport function deferEvent(eventCollection, eventBody){\n\n  if (arguments.length !== 2 || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvent method');\n    return;\n  }\n\n  this.queue.events[eventCollection] = this.queue.events[eventCollection] || [];\n  this.queue.events[eventCollection].push(eventBody);\n  this.queue.capacity++;\n  if (!this.queue.timer) {\n    this.queue.start();\n  }\n  this.emit('deferEvent', eventCollection, eventBody);\n  return this;\n}\n\nexport function deferEvents(eventsHash){\n  var self = this;\n\n  if (arguments.length !== 1 || typeof eventsHash !== 'object') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvents method');\n    return;\n  }\n\n  each(eventsHash, function(eventList, eventCollection){\n    self.queue.events[eventCollection] = self.queue.events[eventCollection] || [];\n    self.queue.events[eventCollection] = self.queue.events[eventCollection].concat(eventList);\n    self.queue.capacity = self.queue.capacity + eventList.length;\n    if (!self.queue.timer) {\n      self.queue.start();\n    }\n  });\n  self.emit('deferEvents', eventsHash);\n  return self;\n}\n\nexport function queueCapacity(num){\n  if (!arguments.length) return this.queue.config.capacity;\n  this.queue.config.capacity = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function queueInterval(num){\n  if (!arguments.length) return this.queue.config.interval;\n  this.queue.config.interval = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function recordDeferredEvents(){\n  const self = this;\n\n  if (self.queue.capacity > 0) {\n    self.queue.pause();\n    let clonedQueueConfig = { ...self.queue.config };\n    let clonedQueueEvents = { ...self.queue.events };\n    self.queue = queue();\n    self.queue.config = clonedQueueConfig;\n    self.queue.on('flush', function(){\n      self.recordDeferredEvents();\n    });\n    self.emit('recordDeferredEvents', clonedQueueEvents);\n    self.recordEvents(clonedQueueEvents, (err, res) => {\n      if (err) {\n        self.emit('recordDeferredEventsError', err, clonedQueueEvents);\n      }\n    });\n  }\n  return self;\n}\n\nfunction handleValidationError(message){\n  this.emit('error', `Event(s) not deferred: ${message}`);\n}\n","// placeholder for future implementation\nmodule.exports = {\n  getFromCache: () => {},\n  saveToCache: () => {}\n}\n","export const MD5 = function(d){const result = M(V(Y(X(d),8*d.length)));return result.toLowerCase()};function M(d){for(var _,m=\"0123456789ABCDEF\",f=\"\",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _=\"\",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}\n\nexport default MD5;\n","import 'promise-polyfill/src/polyfill';\n\nimport md5 from './md5';\nimport { getFromCache, saveToCache } from './cache-browser';\n\nimport configDefault from '../config-default.js';\n\nlet uniqueIds = [];\n\nexport const isUnique = (customCacheConfig, extendedEventBody) => {\n  const configCache = { ...configDefault.cache, ...customCacheConfig.cache };\n  const stringifiedEvent = JSON.stringify(extendedEventBody);\n  const { hashingMethod } = configCache;\n  const hash = hashingMethod && hashingMethod.toLowerCase() === 'md5'\n    ? md5(stringifiedEvent) : stringifiedEvent;\n  const expiryTime = configCache.maxAge ? (Date.now() + configCache.maxAge) : undefined;\n  const item = {\n    hash,\n    expiryTime\n  };\n  if (expiryTime){\n    const now = Date.now();\n    uniqueIds = uniqueIds.filter(item => item.expiryTime > now);\n  }\n\n  const alreadySentEvent = uniqueIds.find(item => item.hash === hash);\n  if (alreadySentEvent) {\n    if (alreadySentEvent.expiryTime && alreadySentEvent.expiryTime < Date.now()) {\n      uniqueIds = uniqueIds.filter(item => item.hash !== hash);\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n  uniqueIds.push(item);\n  if (configCache.storage && configCache.storage.toLowerCase() === 'indexeddb') {\n    return getFromCache(hash, configCache).then(alreadySentEvent => {\n      if (alreadySentEvent) {\n        return false;\n      }\n      saveToCache(hash, configCache);\n      return true;\n    });\n  }\n\n  return Promise.resolve(true);\n}\n\nexport default isUnique;\n","module.exports = require(\"https\");","module.exports = require(\"http\");","import 'promise-polyfill/src/polyfill';\n\nimport http from 'http';\nimport https from 'https';\n\nimport configDefault from '../config-default.js';\n\nexport default function(options) {\n\n  const configRetry = {\n    ...configDefault.retry,\n    ...(options.retry || {})\n  };\n\n  const retriesLimit = configRetry.limit;\n  const retryInitialDelay = configRetry.initialDelay;\n  const retryOn = configRetry.retryOnResponseStatuses;\n  const { callback } = options;\n  let retriesCount = 0;\n\n  if (retryOn && !(retryOn instanceof Array)) {\n    throw {\n      name: 'ArgumentError',\n      message: 'retryOn property expects an array'\n    }\n  }\n\n  const protocol = (options.protocol === 'http') ? http : https;\n\n  const parseBody = (responseBody) => {\n    return new Promise((resolve, reject) => {\n      let response;\n      let error;\n      try {\n        response = JSON.parse(responseBody);\n      }\n      catch (e) {\n        // Parsing Error\n        error = e;\n      }\n      if (!error && response.error_code) {\n        // API Error\n        error = new Error(response.message || 'Unknown error occurred');\n        error.code = response.error_code;\n        reject(error);\n      }\n      resolve(response);\n    });\n  };\n\n  return new Promise((resolve, reject) => {\n    const wrappedRequest = (n) => {\n      let req = protocol.request(options.config, (response) => {\n        let body = '';\n        response.on('data', (d)  => {\n          body += d;\n        });\n        response.on('end', ()  => {\n          if (retryOn.indexOf(response.statusCode) === -1) {\n            parseBody(body).then(parsedBody => {\n              resolve(parsedBody);\n              if (callback) callback(null, parsedBody);\n            }).catch(err => {\n              reject(err);\n              if (callback) callback(err, null);\n            });\n          } else {\n            if (n > 0) {\n              retry();\n            } else {\n              if (callback) callback(body, null);\n              reject(body);\n            }\n          }\n        });\n      });\n      req.on('error', (err) => {\n        if (n > 0) {\n          retry();\n        } else {\n          if (callback) callback(body, null);\n          reject(err);\n        }\n      });\n      req.write(options.data);\n      req.end();\n    };\n\n    function retry() {\n      retriesCount = retriesCount + 1;\n      setTimeout(function() {\n          wrappedRequest(retriesLimit - retriesCount);\n        }, 2^retriesCount * retryInitialDelay);\n    }\n\n    wrappedRequest(retriesLimit - retriesCount);\n  });\n};\n","import 'promise-polyfill/src/polyfill';\n\nimport Keen from './index';\nimport { version } from '../package.json';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { getExtendedEventBody } from './extend-events';\n\nimport nodeRequestRetry from './utils/nodeRequestRetry';\nimport isUnique from './utils/unique';\n\n// ------------------------------\n// .recordEvent\n// ------------------------------\n\nexport function recordEvent(eventCollectionOrConfigObject, eventBody, callback){\n  let eventCollection = eventCollectionOrConfigObject;\n  let unique;\n  let configObject;\n  let clientConfig = this.config;\n\n  if (typeof eventCollectionOrConfigObject === 'object'\n    && eventCollectionOrConfigObject) {\n    // slowly but surely we migrate to one object with all args\n    configObject = eventCollectionOrConfigObject;\n    eventCollection = eventCollectionOrConfigObject.collection\n      || eventCollectionOrConfigObject.event_collection;\n    eventBody = eventCollectionOrConfigObject.event;\n    callback = eventCollectionOrConfigObject.callback;\n    unique = eventCollectionOrConfigObject.unique;\n  }\n\n  let data = {};\n  let extendedEventBody = {};\n\n  if (!checkValidation.call(this, callback)) {\n    return;\n  }\n\n  if (!eventCollection || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Collection name must be a string.', callback);\n    return;\n  }\n\n  extend(data, eventBody);\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n\n  getExtendedEventBody(extendedEventBody, this.extensions.events);\n  getExtendedEventBody(extendedEventBody, this.extensions.collections[eventCollection]);\n  getExtendedEventBody(extendedEventBody, [data]);\n\n  if (unique) {\n    return isUnique(configObject, extendedEventBody).then(isUniqueResult => {\n      if (!isUniqueResult) {\n        return Promise.resolve({\n          created: false,\n          message: '[NOT_UNIQUE] This event has already been recorded'\n        });\n      }\n      return recordEvent.call(this, { ...eventCollectionOrConfigObject, unique: undefined });\n    });\n  }\n\n  this.emit('recordEvent', eventCollection, extendedEventBody);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\n    return false;\n  }\n\n  return sendEventData.call(this, encodeURIComponent(eventCollection), extendedEventBody, callback);\n}\n\n\n\n// ------------------------------\n// .recordEvents\n// ------------------------------\n\nexport function recordEvents(eventsHash, callback){\n  const self = this;\n  let extendedEventsHash = {};\n\n  if (!checkValidation.call(this, callback)) {\n    return;\n  }\n\n  if (arguments.length > 2) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #recordEvents method', callback);\n    return;\n  }\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  each(eventsHash, function(eventList, eventCollection){\n    // Find or create collection on new hash\n    extendedEventsHash[eventCollection] = extendedEventsHash[eventCollection] || [];\n    // Loop over each eventBody in the existing hash\n    each(eventList, function(eventBody, index){\n      // Create a new data object\n      var extendedEventBody = {};\n      // Process \"events\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.events);\n      // Process \"collection\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.collections[eventCollection]);\n      // Blend existing eventBody data into the result\n      getExtendedEventBody(extendedEventBody, [eventBody]);\n      // Push extendedEventBody into new hash\n      extendedEventsHash[eventCollection].push(extendedEventBody);\n    });\n  });\n\n  this.emit('recordEvents', extendedEventsHash);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', callback);\n    return false;\n  }\n\n  return sendEventData.call(this, undefined, extendedEventsHash, callback);\n}\n\n// ------------------------------\n// Validation\n// ------------------------------\n\nfunction checkValidation(callback){\n  if (!this.projectId()) {\n    handleValidationError.call(this, 'Keen.Client is missing a projectId property.', callback);\n    return false;\n  }\n  if (!this.writeKey()) {\n    handleValidationError.call(this, 'Keen.Client is missing a writeKey property.', callback);\n    return false;\n  }\n  return true;\n}\n\nfunction handleValidationError(message, cb){\n  const err = 'Event(s) not recorded: ' + message;\n  this.emit('error', err);\n  if (cb) {\n    cb.call(this, err, null);\n  }\n}\n\nfunction sendEventData(path, eventData, callback){\n  const data = JSON.stringify(eventData);\n\n  let urlPath = this.url('events', path)\n    .replace(this.config.protocol + '://' + this.config.host, '');\n\n  const config = {\n    host: this.config.host,\n    path: urlPath,\n    method: 'POST',\n    headers: {\n      'Authorization': this.writeKey(),\n      'Content-Type': 'application/json',\n      'Content-Length': Buffer.byteLength(data),\n      'keen-sdk': `javascript-${version}`\n    },\n    ...this.config.nodeRequestConfig\n  };\n\n  return nodeRequestRetry({\n    retry: this.config.retry,\n    protocol: this.config.protocol,\n    config,\n    data,\n    callback\n  });\n}\n","function lsTest(){\n  const test = 'test';\n  try {\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n      return true;\n  } catch(e) {\n      return false;\n  }\n}\n\nexport const isLocalStorageAvailable = lsTest();","import { isLocalStorageAvailable } from './localStorage';\n\nexport function setOptOut(optOut = true) {\n    if (!isLocalStorageAvailable) return;\n\n    if (optOut) {\n        localStorage.setItem('optout', optOut);\n        return;\n    }\n\n    localStorage.removeItem('optout');\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__22__;","module.exports = __WEBPACK_EXTERNAL_MODULE__23__;","import KeenCore from './index';\nimport extend from 'keen-core/lib/utils/extend';\nimport {\n  recordEvent,\n  recordEvents\n} from './record-events-server';\nimport {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n} from './defer-events';\nimport { extendEvent, extendEvents } from './extend-events';\nimport { getDatetimeIndex } from './helpers/getDatetimeIndex';\nimport { getUniqueId } from './helpers/getUniqueId';\nimport { deepExtend } from './utils/deepExtend';\nimport { timer } from './utils/timer';\n\n// ------------------------\n// Methods\n// ------------------------\nextend(KeenCore.prototype, {\n  recordEvent,\n  recordEvents\n});\nextend(KeenCore.prototype, {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n});\nextend(KeenCore.prototype, {\n  extendEvent,\n  extendEvents\n});\n\n// ------------------------\n// Helpers\n// ------------------------\nextend(KeenCore.helpers, {\n  getDatetimeIndex,\n  getUniqueId\n});\n\n// ------------------------\n// Utils\n// ------------------------\nextend(KeenCore.utils, {\n  deepExtend,\n  timer\n});\n\nexport const Keen = KeenCore; // deprecated, left for backward compatibility\nexport const KeenTracking = KeenCore;\nmodule.exports = Keen;\n"],"sourceRoot":""}
